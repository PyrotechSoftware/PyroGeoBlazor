"use strict";var LeafletVectorTileMapbox=(()=>{var at=Object.create;var k=Object.defineProperty;var ut=Object.getOwnPropertyDescriptor;var ht=Object.getOwnPropertyNames;var lt=Object.getPrototypeOf,ct=Object.prototype.hasOwnProperty;var M=(t,i)=>()=>(i||t((i={exports:{}}).exports,i),i.exports),ft=(t,i)=>{for(var e in i)k(t,e,{get:i[e],enumerable:!0})},O=(t,i,e,n)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of ht(i))!ct.call(t,s)&&s!==e&&k(t,s,{get:()=>i[s],enumerable:!(n=ut(i,s))||n.enumerable});return t};var K=(t,i,e)=>(e=t!=null?at(lt(t)):{},O(i||!t||!t.__esModule?k(e,"default",{value:t,enumerable:!0}):e,t)),dt=t=>O(k({},"__esModule",{value:!0}),t);var z=M(R=>{R.read=function(t,i,e,n,s){var r,o,a=s*8-n-1,u=(1<<a)-1,l=u>>1,h=-7,d=e?s-1:0,c=e?-1:1,y=t[i+d];for(d+=c,r=y&(1<<-h)-1,y>>=-h,h+=a;h>0;r=r*256+t[i+d],d+=c,h-=8);for(o=r&(1<<-h)-1,r>>=-h,h+=n;h>0;o=o*256+t[i+d],d+=c,h-=8);if(r===0)r=1-l;else{if(r===u)return o?NaN:(y?-1:1)*(1/0);o=o+Math.pow(2,n),r=r-l}return(y?-1:1)*o*Math.pow(2,r-n)};R.write=function(t,i,e,n,s,r){var o,a,u,l=r*8-s-1,h=(1<<l)-1,d=h>>1,c=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:r-1,f=n?1:-1,x=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(a=isNaN(i)?1:0,o=h):(o=Math.floor(Math.log(i)/Math.LN2),i*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+d>=1?i+=c/u:i+=c*Math.pow(2,1-d),i*u>=2&&(o++,u/=2),o+d>=h?(a=0,o=h):o+d>=1?(a=(i*u-1)*Math.pow(2,s),o=o+d):(a=i*Math.pow(2,d-1)*Math.pow(2,s),o=0));s>=8;t[e+y]=a&255,y+=f,a/=256,s-=8);for(o=o<<s|a,l+=s;l>0;t[e+y]=o&255,y+=f,o/=256,l-=8);t[e+y-f]|=x*128}});var Y=M((Xt,q)=>{"use strict";q.exports=g;var B=z();function g(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}g.Varint=0;g.Fixed64=1;g.Bytes=2;g.Fixed32=5;var W=65536*65536,U=1/W,yt=12,X=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8");g.prototype={destroy:function(){this.buf=null},readFields:function(t,i,e){for(e=e||this.length;this.pos<e;){var n=this.readVarint(),s=n>>3,r=this.pos;this.type=n&7,t(s,i,this),this.pos===r&&this.skip(n)}return i},readMessage:function(t,i){return this.readFields(t,i,this.readVarint()+this.pos)},readFixed32:function(){var t=E(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=$(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=E(this.buf,this.pos)+E(this.buf,this.pos+4)*W;return this.pos+=8,t},readSFixed64:function(){var t=E(this.buf,this.pos)+$(this.buf,this.pos+4)*W;return this.pos+=8,t},readFloat:function(){var t=B.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=B.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var i=this.buf,e,n;return n=i[this.pos++],e=n&127,n<128||(n=i[this.pos++],e|=(n&127)<<7,n<128)||(n=i[this.pos++],e|=(n&127)<<14,n<128)||(n=i[this.pos++],e|=(n&127)<<21,n<128)?e:(n=i[this.pos],e|=(n&15)<<28,xt(e,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,i=this.pos;return this.pos=t,t-i>=yt&&X?Pt(this.buf,i,t):St(this.buf,i,t)},readBytes:function(){var t=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,t);return this.pos=t,i},readPackedVarint:function(t,i){if(this.type!==g.Bytes)return t.push(this.readVarint(i));var e=v(this);for(t=t||[];this.pos<e;)t.push(this.readVarint(i));return t},readPackedSVarint:function(t){if(this.type!==g.Bytes)return t.push(this.readSVarint());var i=v(this);for(t=t||[];this.pos<i;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==g.Bytes)return t.push(this.readBoolean());var i=v(this);for(t=t||[];this.pos<i;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==g.Bytes)return t.push(this.readFloat());var i=v(this);for(t=t||[];this.pos<i;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==g.Bytes)return t.push(this.readDouble());var i=v(this);for(t=t||[];this.pos<i;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==g.Bytes)return t.push(this.readFixed32());var i=v(this);for(t=t||[];this.pos<i;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==g.Bytes)return t.push(this.readSFixed32());var i=v(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==g.Bytes)return t.push(this.readFixed64());var i=v(this);for(t=t||[];this.pos<i;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==g.Bytes)return t.push(this.readSFixed64());var i=v(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed64());return t},skip:function(t){var i=t&7;if(i===g.Varint)for(;this.buf[this.pos++]>127;);else if(i===g.Bytes)this.pos=this.readVarint()+this.pos;else if(i===g.Fixed32)this.pos+=4;else if(i===g.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+i)},writeTag:function(t,i){this.writeVarint(t<<3|i)},realloc:function(t){for(var i=this.length||16;i<this.pos+t;)i*=2;if(i!==this.length){var e=new Uint8Array(i);e.set(this.buf),this.buf=e,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),T(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),T(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),T(this.buf,t&-1,this.pos),T(this.buf,Math.floor(t*U),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),T(this.buf,t&-1,this.pos),T(this.buf,Math.floor(t*U),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){pt(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var i=this.pos;this.pos=kt(this.buf,t,this.pos);var e=this.pos-i;e>=128&&H(i,e,this),this.pos=i-1,this.writeVarint(e),this.pos+=e},writeFloat:function(t){this.realloc(4),B.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),B.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var i=t.length;this.writeVarint(i),this.realloc(i);for(var e=0;e<i;e++)this.buf[this.pos++]=t[e]},writeRawMessage:function(t,i){this.pos++;var e=this.pos;t(i,this);var n=this.pos-e;n>=128&&H(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,i,e){this.writeTag(t,g.Bytes),this.writeRawMessage(i,e)},writePackedVarint:function(t,i){i.length&&this.writeMessage(t,wt,i)},writePackedSVarint:function(t,i){i.length&&this.writeMessage(t,_t,i)},writePackedBoolean:function(t,i){i.length&&this.writeMessage(t,Mt,i)},writePackedFloat:function(t,i){i.length&&this.writeMessage(t,mt,i)},writePackedDouble:function(t,i){i.length&&this.writeMessage(t,vt,i)},writePackedFixed32:function(t,i){i.length&&this.writeMessage(t,Vt,i)},writePackedSFixed32:function(t,i){i.length&&this.writeMessage(t,Tt,i)},writePackedFixed64:function(t,i){i.length&&this.writeMessage(t,bt,i)},writePackedSFixed64:function(t,i){i.length&&this.writeMessage(t,Lt,i)},writeBytesField:function(t,i){this.writeTag(t,g.Bytes),this.writeBytes(i)},writeFixed32Field:function(t,i){this.writeTag(t,g.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(t,i){this.writeTag(t,g.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(t,i){this.writeTag(t,g.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(t,i){this.writeTag(t,g.Fixed64),this.writeSFixed64(i)},writeVarintField:function(t,i){this.writeTag(t,g.Varint),this.writeVarint(i)},writeSVarintField:function(t,i){this.writeTag(t,g.Varint),this.writeSVarint(i)},writeStringField:function(t,i){this.writeTag(t,g.Bytes),this.writeString(i)},writeFloatField:function(t,i){this.writeTag(t,g.Fixed32),this.writeFloat(i)},writeDoubleField:function(t,i){this.writeTag(t,g.Fixed64),this.writeDouble(i)},writeBooleanField:function(t,i){this.writeVarintField(t,!!i)}};function xt(t,i,e){var n=e.buf,s,r;if(r=n[e.pos++],s=(r&112)>>4,r<128||(r=n[e.pos++],s|=(r&127)<<3,r<128)||(r=n[e.pos++],s|=(r&127)<<10,r<128)||(r=n[e.pos++],s|=(r&127)<<17,r<128)||(r=n[e.pos++],s|=(r&127)<<24,r<128)||(r=n[e.pos++],s|=(r&1)<<31,r<128))return V(t,s,i);throw new Error("Expected varint not more than 10 bytes")}function v(t){return t.type===g.Bytes?t.readVarint()+t.pos:t.pos+1}function V(t,i,e){return e?i*4294967296+(t>>>0):(i>>>0)*4294967296+(t>>>0)}function pt(t,i){var e,n;if(t>=0?(e=t%4294967296|0,n=t/4294967296|0):(e=~(-t%4294967296),n=~(-t/4294967296),e^4294967295?e=e+1|0:(e=0,n=n+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),gt(e,n,i),Ft(n,i)}function gt(t,i,e){e.buf[e.pos++]=t&127|128,t>>>=7,e.buf[e.pos++]=t&127|128,t>>>=7,e.buf[e.pos++]=t&127|128,t>>>=7,e.buf[e.pos++]=t&127|128,t>>>=7,e.buf[e.pos]=t&127}function Ft(t,i){var e=(t&7)<<4;i.buf[i.pos++]|=e|((t>>>=3)?128:0),t&&(i.buf[i.pos++]=t&127|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=t&127|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=t&127|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=t&127|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=t&127)))))}function H(t,i,e){var n=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(Math.LN2*7));e.realloc(n);for(var s=e.pos-1;s>=t;s--)e.buf[s+n]=e.buf[s]}function wt(t,i){for(var e=0;e<t.length;e++)i.writeVarint(t[e])}function _t(t,i){for(var e=0;e<t.length;e++)i.writeSVarint(t[e])}function mt(t,i){for(var e=0;e<t.length;e++)i.writeFloat(t[e])}function vt(t,i){for(var e=0;e<t.length;e++)i.writeDouble(t[e])}function Mt(t,i){for(var e=0;e<t.length;e++)i.writeBoolean(t[e])}function Vt(t,i){for(var e=0;e<t.length;e++)i.writeFixed32(t[e])}function Tt(t,i){for(var e=0;e<t.length;e++)i.writeSFixed32(t[e])}function bt(t,i){for(var e=0;e<t.length;e++)i.writeFixed64(t[e])}function Lt(t,i){for(var e=0;e<t.length;e++)i.writeSFixed64(t[e])}function E(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+t[i+3]*16777216}function T(t,i,e){t[e]=i,t[e+1]=i>>>8,t[e+2]=i>>>16,t[e+3]=i>>>24}function $(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+(t[i+3]<<24)}function St(t,i,e){for(var n="",s=i;s<e;){var r=t[s],o=null,a=r>239?4:r>223?3:r>191?2:1;if(s+a>e)break;var u,l,h;a===1?r<128&&(o=r):a===2?(u=t[s+1],(u&192)===128&&(o=(r&31)<<6|u&63,o<=127&&(o=null))):a===3?(u=t[s+1],l=t[s+2],(u&192)===128&&(l&192)===128&&(o=(r&15)<<12|(u&63)<<6|l&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(u=t[s+1],l=t[s+2],h=t[s+3],(u&192)===128&&(l&192)===128&&(h&192)===128&&(o=(r&15)<<18|(u&63)<<12|(l&63)<<6|h&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,n+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),n+=String.fromCharCode(o),s+=a}return n}function Pt(t,i,e){return X.decode(t.subarray(i,e))}function kt(t,i,e){for(var n=0,s,r;n<i.length;n++){if(s=i.charCodeAt(n),s>55295&&s<57344)if(r)if(s<56320){t[e++]=239,t[e++]=191,t[e++]=189,r=s;continue}else s=r-55296<<10|s-56320|65536,r=null;else{s>56319||n+1===i.length?(t[e++]=239,t[e++]=191,t[e++]=189):r=s;continue}else r&&(t[e++]=239,t[e++]=191,t[e++]=189,r=null);s<128?t[e++]=s:(s<2048?t[e++]=s>>6|192:(s<65536?t[e++]=s>>12|224:(t[e++]=s>>18|240,t[e++]=s>>12&63|128),t[e++]=s>>6&63|128),t[e++]=s&63|128)}return e}});var Q=M((qt,J)=>{"use strict";J.exports=b;function b(t,i){this.x=t,this.y=i}b.prototype={clone:function(){return new b(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,i){return this.clone()._rotateAround(t,i)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var i=t.x-this.x,e=t.y-this.y;return i*i+e*e},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,i){return Math.atan2(this.x*i-this.y*t,this.x*t+this.y*i)},_matMult:function(t){var i=t[0]*this.x+t[1]*this.y,e=t[2]*this.x+t[3]*this.y;return this.x=i,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var i=Math.cos(t),e=Math.sin(t),n=i*this.x-e*this.y,s=e*this.x+i*this.y;return this.x=n,this.y=s,this},_rotateAround:function(t,i){var e=Math.cos(t),n=Math.sin(t),s=i.x+e*(this.x-i.x)-n*(this.y-i.y),r=i.y+n*(this.x-i.x)+e*(this.y-i.y);return this.x=s,this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};b.convert=function(t){return t instanceof b?t:Array.isArray(t)?new b(t[0],t[1]):t}});var I=M((Yt,Z)=>{"use strict";var Bt=Q();Z.exports=S;function S(t,i,e,n,s){this.properties={},this.extent=e,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=s,t.readFields(Et,this,i)}function Et(t,i,e){t==1?i.id=e.readVarint():t==2?Dt(e,i):t==3?i.type=e.readVarint():t==4&&(i._geometry=e.pos)}function Dt(t,i){for(var e=t.readVarint()+t.pos;t.pos<e;){var n=i._keys[t.readVarint()],s=i._values[t.readVarint()];i.properties[n]=s}}S.types=["Unknown","Point","LineString","Polygon"];S.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var i=t.readVarint()+t.pos,e=1,n=0,s=0,r=0,o=[],a;t.pos<i;){if(n<=0){var u=t.readVarint();e=u&7,n=u>>3}if(n--,e===1||e===2)s+=t.readSVarint(),r+=t.readSVarint(),e===1&&(a&&o.push(a),a=[]),a.push(new Bt(s,r));else if(e===7)a&&a.push(a[0].clone());else throw new Error("unknown command "+e)}return a&&o.push(a),o};S.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var i=t.readVarint()+t.pos,e=1,n=0,s=0,r=0,o=1/0,a=-1/0,u=1/0,l=-1/0;t.pos<i;){if(n<=0){var h=t.readVarint();e=h&7,n=h>>3}if(n--,e===1||e===2)s+=t.readSVarint(),r+=t.readSVarint(),s<o&&(o=s),s>a&&(a=s),r<u&&(u=r),r>l&&(l=r);else if(e!==7)throw new Error("unknown command "+e)}return[o,u,a,l]};S.prototype.toGeoJSON=function(t,i,e){var n=this.extent*Math.pow(2,e),s=this.extent*t,r=this.extent*i,o=this.loadGeometry(),a=S.types[this.type],u,l;function h(y){for(var f=0;f<y.length;f++){var x=y[f],p=180-(x.y+r)*360/n;y[f]=[(x.x+s)*360/n-180,360/Math.PI*Math.atan(Math.exp(p*Math.PI/180))-90]}}switch(this.type){case 1:var d=[];for(u=0;u<o.length;u++)d[u]=o[u][0];o=d,h(o);break;case 2:for(u=0;u<o.length;u++)h(o[u]);break;case 3:for(o=Ct(o),u=0;u<o.length;u++)for(l=0;l<o[u].length;l++)h(o[u][l]);break}o.length===1?o=o[0]:a="Multi"+a;var c={type:"Feature",geometry:{type:a,coordinates:o},properties:this.properties};return"id"in this&&(c.id=this.id),c};function Ct(t){var i=t.length;if(i<=1)return[t];for(var e=[],n,s,r=0;r<i;r++){var o=Rt(t[r]);o!==0&&(s===void 0&&(s=o<0),s===o<0?(n&&e.push(n),n=[t[r]]):n.push(t[r]))}return n&&e.push(n),e}function Rt(t){for(var i=0,e=0,n=t.length,s=n-1,r,o;e<n;s=e++)r=t[e],o=t[s],i+=(o.x-r.x)*(r.y+o.y);return i}});var A=M((Jt,et)=>{"use strict";var Wt=I();et.exports=tt;function tt(t,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(It,this,i),this.length=this._features.length}function It(t,i,e){t===15?i.version=e.readVarint():t===1?i.name=e.readString():t===5?i.extent=e.readVarint():t===2?i._features.push(e.pos):t===3?i._keys.push(e.readString()):t===4&&i._values.push(At(e))}function At(t){for(var i=null,e=t.readVarint()+t.pos;t.pos<e;){var n=t.readVarint()>>3;i=n===1?t.readString():n===2?t.readFloat():n===3?t.readDouble():n===4?t.readVarint64():n===5?t.readVarint():n===6?t.readSVarint():n===7?t.readBoolean():null}return i}tt.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var i=this._pbf.readVarint()+this._pbf.pos;return new Wt(this._pbf,i,this.extent,this._keys,this._values)}});var nt=M((Qt,it)=>{"use strict";var Nt=A();it.exports=jt;function jt(t,i){this.layers=t.readFields(Gt,{},i)}function Gt(t,i,e){if(t===3){var n=new Nt(e,e.readVarint()+e.pos);n.length&&(i[n.name]=n)}}});var rt=M((Zt,D)=>{D.exports.VectorTile=nt();D.exports.VectorTileFeature=I();D.exports.VectorTileLayer=A()});var Ut={};ft(Ut,{default:()=>zt,mapboxVectorTileLayer:()=>P});var st=K(Y(),1),ot=K(rt(),1);function Ot(t,i,e,n){let s=t instanceof Uint8Array?t:new Uint8Array(t),r=new st.default(s),o=new ot.VectorTile(r),a=[];for(let u in o.layers){let l=o.layers[u];for(let h=0;h<l.length;h++)try{let d=l.feature(h),c=d.toGeoJSON(e,n,i);a.push({layer:u,id:d.id,properties:d.properties||{},attributes:d.properties||{},raw:d,geometry:c&&c.geometry?c.geometry:c})}catch(d){}}return a}var N=class extends L.GridLayer{constructor(e,n){var r,o,a,u;if(!e)throw new Error("WMTSVectorTile: urlTemplate is required");let s=Object.assign({},n,{tileSize:(r=n.tileSize)!=null?r:256,tilePixelRatio:(o=n.tilePixelRatio)!=null?o:typeof window!="undefined"&&window.devicePixelRatio||1,format:(a=n.format)!=null?a:"MVT",pane:(u=n.pane)!=null?u:"overlayPane"});super(s);this._hoveredFeatureKey=null;this._hoveredFeature=null;this._featureStyles=new Map;this.selectedFeatureId=null;this.selectedFeatureLayer=null;this._selectedFeature=null;this.options=s,this.urlTemplate=e}onRemove(e){return super.onRemove(e)}createTile(e,n){let s=this.getTileSize(),r=document.createElement("canvas");r.className="leaflet-tile leaflet-interactive",r.style.pointerEvents="auto";let o=this.options.tilePixelRatio||window.devicePixelRatio||1;r.width=Math.max(1,Math.round(s.x*o)),r.height=Math.max(1,Math.round(s.y*o)),r.style.width=`${s.x}px`,r.style.height=`${s.y}px`;let a=r.getContext("2d");if(!a)return n(new Error("Canvas not supported")),r;a.scale(o,o),a.clearRect(0,0,s.x,s.y);let u=e.z,l=e.x,h=e.y,d=this.options.tms?(1<<u)-1-h:h,c=this.urlTemplate.replace("{z}",String(u)).replace("{x}",String(l)).replace("{y}",String(d));r.__mvt_tile={coords:e,z:u},r.addEventListener("click",f=>this._onTileClick(f)),r.addEventListener("dblclick",f=>this._onTileDoubleClick(f)),this.options.enableFeatureContextMenu&&r.addEventListener("contextmenu",f=>this._onTileContextMenu(f)),r.addEventListener("mousemove",f=>this._onTileMouseMove(f)),r.addEventListener("mouseout",f=>this._onTileMouseOut(f));let y=this.options.format==="MVT"?"application/vnd.mapbox-vector-tile":this.options.format||"application/vnd.mapbox-vector-tile";return fetch(c,{headers:{Accept:y}}).then(f=>{if(!f.ok)throw new Error(`Tile fetch failed: ${f.status}`);return f.arrayBuffer()}).then(f=>{try{let x=Ot(f,u,l,h);this._renderFeaturesToCanvas(x,a,e,s.x,u),a.canvas.__mvtFeatures=a.canvas.__mvtFeatures||[],a.canvas.__mvtFeatures=x,n(void 0,r)}catch(x){console.warn("Vector tile decode/render error",x),n(x)}}).catch(f=>{console.warn("Tile fetch error",f),n(f)}),r}_renderFeaturesToCanvas(e,n,s,r,o){let a=r,u=this._map;(!e||e.length===0)&&window.__MVT_DEBUG__&&console.debug(`MapboxVectorTile.WMTS: no features decoded for tile z="${o}", x="${s.x}", y="${s.y}"`),window.__MVT_DEBUG__&&(n.save(),n.strokeStyle="magenta",n.lineWidth=1/(this.options.tilePixelRatio||window.devicePixelRatio||1),n.strokeRect(0,0,r,r),n.restore());let h=[],d=new Set;for(let c of e){if(window.__MVT_DEBUG__)try{console.debug("WMTSVectorTile feature",{layer:c.layer,type:c.geometry&&c.geometry.type,properties:c.properties,attributes:c.attributes,sample:c.geometry&&c.geometry.coordinates&&(c.geometry.coordinates.length?c.geometry.coordinates[0]:c.geometry.coordinates)})}catch(p){}let y=c.layer,f=this._getStyleForLayer(y,c);n.save(),n.fillStyle=f.fill,n.strokeStyle=f.stroke,n.lineWidth=f.lineWidth;let x=c.geometry;if(!x){n.restore();continue}switch(x.type){case"Point":{let[p,F]=x.coordinates,w=this._projectPoint(p,F,o,s);this._drawPoint(n,w.x,w.y,f);break}case"MultiPoint":{for(let p of x.coordinates){let[F,w]=p,m=this._projectPoint(F,w,o,s);this._drawPoint(n,m.x,m.y,f)}break}case"LineString":{this._drawLineString(n,x.coordinates,o,s,f);break}case"MultiLineString":{for(let p of x.coordinates)this._drawLineString(n,p,o,s,f);break}case"Polygon":{this._drawPolygon(n,x.coordinates,o,s,f);break}case"MultiPolygon":{let p=x.coordinates;for(let F of p)this._drawPolygon(n,F,o,s,f);break}default:break}n.restore()}}_getStyleForLayer(e,n){let s=this.options.style||{},r=s.layers||{},o=e&&r[e]?r[e]:void 0,a={fill:o&&o.fill?o.fill:s.defaultFill||"rgba(0,0,0,0.1)",stroke:o&&o.stroke?o.stroke:s.defaultStroke||"rgba(0,0,0,0.6)",lineWidth:o&&o.lineWidth!==void 0?o.lineWidth:s.defaultLineWidth||1};if(n){let u=this._getFeatureKey(n);if(u){let l=this._featureStyles.get(u);if(l)return{fill:l.fill!==void 0?l.fill:a.fill,stroke:l.stroke!==void 0?l.stroke:a.stroke,lineWidth:l.lineWidth!==void 0?l.lineWidth:a.lineWidth}}}return a}_projectPoint(e,n,s,r){let o=Math.abs(e)>360||Math.abs(n)>90||e>4096||n>4096,a=n,u=e;if(o){let c=e,y=n,f=r.x+c/4096,x=r.y+y/4096,p=Math.pow(2,s);u=f/p*360-180,a=Math.atan(Math.sinh(Math.PI*(1-2*x/p)))*180/Math.PI}let l=this._map.project([a,u],s),h=L.point(r.x*this.getTileSize().x,r.y*this.getTileSize().y);return{x:l.x-h.x,y:l.y-h.y}}_drawPoint(e,n,s,r){e.beginPath(),e.arc(n,s,4,0,Math.PI*2),r.fill&&e.fill(),r.stroke&&e.stroke()}_drawLineString(e,n,s,r,o){if(!(!n||n.length===0)){e.beginPath();for(let a=0;a<n.length;a++){let[u,l]=n[a],h=this._projectPoint(u,l,s,r);a===0?e.moveTo(h.x,h.y):e.lineTo(h.x,h.y)}o.stroke&&e.stroke()}}_drawPolygon(e,n,s,r,o){if(!(!n||n.length===0)){e.beginPath();for(let a=0;a<n.length;a++){let u=n[a];for(let l=0;l<u.length;l++){let h=u[l],d=h[0],c=h[1],y=this._projectPoint(d,c,s,r);l===0?e.moveTo(y.x,y.y):e.lineTo(y.x,y.y)}}o.fill&&e.fill(),o.stroke&&e.stroke()}}_getAnchorPosition(e,n,s){try{switch(e.type){case"Point":{let[r,o]=e.coordinates;return this._projectPoint(r,o,n,s)}case"MultiPoint":{let[r,o]=e.coordinates[0];return this._projectPoint(r,o,n,s)}case"LineString":{let r=e.coordinates,o=Math.floor(r.length/2),[a,u]=r[o];return this._projectPoint(a,u,n,s)}case"Polygon":{let r=e.coordinates;if(!r||r.length===0)return null;let o=r[0],a=0,u=0,l=0;for(let c of o)a+=c[0],u+=c[1],l++;if(l===0)return null;let h=a/l,d=u/l;return this._projectPoint(h,d,n,s)}default:return null}}catch(r){return null}}_getFeatureKey(e){return e.id!==void 0&&e.id!==null?`${e.layer}:${String(e.id)}`:null}setFeatureStyle(e,n){let s=this._getFeatureKey(e);if(!s)return!1;this._featureStyles.set(s,n);try{this.redraw()}catch(r){}return!0}setFeatureStyleById(e,n,s){let r=`${e}:${String(n)}`;this._featureStyles.set(r,s);try{this.redraw()}catch(o){}}clearFeatureStyle(e){let n=this._getFeatureKey(e);if(!n)return!1;let s=this._featureStyles.delete(n);try{this.redraw()}catch(r){}return s}clearFeatureStyleById(e,n){let s=`${e}:${String(n)}`,r=this._featureStyles.delete(s);try{this.redraw()}catch(o){}return r}clearAllFeatureStyles(){this._featureStyles.clear();try{this.redraw()}catch(e){}}_hitTestGeom(e,n,s,r,o){var u;let a=(u=this.options.hitTolerance)!=null?u:6;switch(e.type){case"Point":{let l=this._projectPoint(e.coordinates[0],e.coordinates[1],r,o),h=l.x-n,d=l.y-s;return Math.hypot(h,d)<=a}case"MultiPoint":{for(let l of e.coordinates){let h=this._projectPoint(l[0],l[1],r,o);if(Math.hypot(h.x-n,h.y-s)<=a)return!0}return!1}case"LineString":{let l=Math.max(1,Math.round(a*.66));for(let h=0;h<e.coordinates.length-1;h++){let d=this._projectPoint(e.coordinates[h][0],e.coordinates[h][1],r,o),c=this._projectPoint(e.coordinates[h+1][0],e.coordinates[h+1][1],r,o);if(this._pointToSegmentDistance(n,s,d.x,d.y,c.x,c.y)<=l)return!0}return!1}case"Polygon":{let h=e.coordinates[0].map(d=>this._projectPoint(d[0],d[1],r,o));return this._pointInPolygon({x:n,y:s},h)}case"MultiPolygon":{let l=e.coordinates;for(let h of l){if(!h||h.length===0)continue;let c=h[0].map(y=>this._projectPoint(y[0],y[1],r,o));if(this._pointInPolygon({x:n,y:s},c))return!0}return!1}default:return!1}}_pointToSegmentDistance(e,n,s,r,o,a){let u=e-s,l=n-r,h=o-s,d=a-r,c=u*h+l*d,y=h*h+d*d,f=-1;y!==0&&(f=c/y);let x,p;f<0?(x=s,p=r):f>1?(x=o,p=a):(x=s+f*h,p=r+f*d);let F=e-x,w=n-p;return Math.hypot(F,w)}_pointInPolygon(e,n){let s=!1;for(let r=0,o=n.length-1;r<n.length;o=r++){let a=n[r].x,u=n[r].y,l=n[o].x,h=n[o].y;u>e.y!=h>e.y&&e.x<(l-a)*(e.y-u)/(h-u)+a&&(s=!s)}return s}_onTileClick(e){let n=e.currentTarget;if(!n)return;let s=n.__mvtFeatures;if(!s||s.length===0)return;let r=n.__mvt_tile;if(!r)return;let o=n.getBoundingClientRect(),a=e.clientX-o.left,u=e.clientY-o.top,l=this.options.tilePixelRatio||window.devicePixelRatio||1,h=a*l,d=u*l;for(let c of s){let y=c.geometry;if(y&&this._hitTestGeom(y,h,d,r.z,r.coords)){let f,x=this._getAnchorPosition(y,r.z,r.coords),p=this._map;if(x&&p){let _=r.coords.x*this.getTileSize().x+x.x,C=r.coords.y*this.getTileSize().y+x.y,G=L.point(_,C);f=p.unproject?p.unproject(G,r.z):p.layerPointToLatLng(G)}let F=this._selectedFeature?this._getFeatureKey(this._selectedFeature):null,w=this._getFeatureKey(c);if(F&&w&&F===w){let _=this._selectedFeature;this._selectedFeature=null,this.selectedFeatureId=null,this.selectedFeatureLayer=null;try{this.fire&&this.fire("featureunselected",{layerName:_&&_.layer,feature:_,originalEvent:e})}catch(C){}return}if(this._selectedFeature){let _=this._selectedFeature;this._selectedFeature=null,this.selectedFeatureId=null,this.selectedFeatureLayer=null;try{this.fire&&this.fire("featureunselected",{layerName:_.layer,feature:_,originalEvent:e})}catch(C){}}this._selectedFeature=c,this.selectedFeatureId=c.id!==void 0?c.id:null,this.selectedFeatureLayer=c.layer;let m={layerName:c.layer,feature:c,latlng:f,originalEvent:e};try{this.fire&&this.fire("featureclick",m),this.fire&&this.fire("featureselected",m)}catch(_){}return}}if(this._selectedFeature){let c=this._selectedFeature;this._selectedFeature=null,this.selectedFeatureId=null,this.selectedFeatureLayer=null;try{this.fire&&this.fire("featureunselected",{layerName:c.layer,feature:c,originalEvent:e})}catch(y){}}}_onTileDoubleClick(e){let n=e.currentTarget;if(!n)return;let s=n.__mvtFeatures;if(!s||s.length===0)return;let r=n.__mvt_tile;if(!r)return;let o=n.getBoundingClientRect(),a=e.clientX-o.left,u=e.clientY-o.top,l=this.options.tilePixelRatio||window.devicePixelRatio||1,h=a*l,d=u*l;for(let c of s){let y=c.geometry;if(y&&this._hitTestGeom(y,h,d,r.z,r.coords)){let f,x=this._getAnchorPosition(y,r.z,r.coords),p=this._map;if(x&&p){let w=r.coords.x*this.getTileSize().x+x.x,m=r.coords.y*this.getTileSize().y+x.y,_=L.point(w,m);f=p.unproject?p.unproject(_,r.z):p.layerPointToLatLng(_)}let F={layerName:c.layer,feature:c,latlng:f,originalEvent:e};try{this.fire&&this.fire("featuredblclick",F)}catch(w){}return}}}_onTileContextMenu(e){try{e.preventDefault()}catch(c){}let n=e.currentTarget;if(!n)return;let s=n.__mvtFeatures;if(!s||s.length===0)return;let r=n.__mvt_tile;if(!r)return;let o=n.getBoundingClientRect(),a=e.clientX-o.left,u=e.clientY-o.top,l=this.options.tilePixelRatio||window.devicePixelRatio||1,h=a*l,d=u*l;for(let c of s){let y=c.geometry;if(y&&this._hitTestGeom(y,h,d,r.z,r.coords)){let f,x=this._getAnchorPosition(y,r.z,r.coords),p=this._map;if(x&&p){let w=r.coords.x*this.getTileSize().x+x.x,m=r.coords.y*this.getTileSize().y+x.y,_=L.point(w,m);f=p.unproject?p.unproject(_,r.z):p.layerPointToLatLng(_)}let F={layerName:c.layer,feature:c,latlng:f,originalEvent:e};try{this.fire&&this.fire("featurecontextmenu",F)}catch(w){}return}}}_onTileMouseMove(e){let n=e.currentTarget;if(!n)return;let s=n.__mvtFeatures;if(!s||s.length===0)return;let r=n.__mvt_tile;if(!r)return;let o=n.getBoundingClientRect(),a=e.clientX-o.left,u=e.clientY-o.top,l=this.options.tilePixelRatio||window.devicePixelRatio||1,h=a*l,d=u*l,c=null;for(let x of s){let p=x.geometry;if(p&&this._hitTestGeom(p,h,d,r.z,r.coords)){c=x;break}}let y=c?this._getFeatureKey(c):null,f=this._hoveredFeatureKey;if(c&&y&&y!==f){if(this._hoveredFeature&&f){let p={layerName:this._hoveredFeature.layer,feature:this._hoveredFeature,originalEvent:e};try{this.fire&&this.fire("featuremouseout",p)}catch(F){}}this._hoveredFeatureKey=y,this._hoveredFeature=c;let x={layerName:c.layer,feature:c,originalEvent:e};try{this.fire&&this.fire("featuremouseover",x)}catch(p){}}else if(!c&&f){let x=e.relatedTarget;if(!(x&&x.tagName==="CANVAS"&&x.__mvt_tile)){let F=this._hoveredFeature;if(this._hoveredFeatureKey=null,this._hoveredFeature=null,F){let w={layerName:F.layer,feature:F,originalEvent:e};try{this.fire&&this.fire("featuremouseout",w)}catch(m){}}}}}_onTileMouseOut(e){}};function P(t,i){return new N(t,i)}try{if(typeof window!="undefined"&&window.L){let t=window.L;t.mapboxVectorTileLayer||(t.mapboxVectorTileLayer=P)}}catch(t){}var j=globalThis;j&&!j.wmtsVectorTile&&(j.wmtsVectorTile=P);try{globalThis.L&&!globalThis.L.mapboxVectorTileLayer&&(globalThis.L.mapboxVectorTileLayer=P)}catch(t){}var zt=Kt;return dt(Ut);})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
//# sourceMappingURL=leaflet-vectortile-mapbox.js.map
