@page "/geojson-layers"
@using PyroGeoBlazor.Demo.Models
@using PyroGeoBlazor.Leaflet.Components
@using PyroGeoBlazor.Leaflet.Models

<PageTitle>GeoJSON Layers - PyroGeoBlazor Demo</PageTitle>

<div style="display: flex; flex-direction: column; height: 100%; overflow: hidden;">
    <div style="flex: 0 0 auto; overflow-y: auto;">
        <MudContainer MaxWidth="MaxWidth.False" Class="pa-4 pb-0">
            <MudText Typo="Typo.h4" Class="mb-2">GeoJSON Layers</MudText>
            <MudText Typo="Typo.body2" Color="Color.Secondary" Class="mb-4">Work with GeoJSON data including features, styling, filtering, and callbacks</MudText>

            <MudGrid>
                <MudItem xs="12" sm="4">
                    <MudCard>
                        <MudCardHeader>
                            <MudText Typo="Typo.h6">Data Features</MudText>
                        </MudCardHeader>
                        <MudCardContent>
                            <MudList Dense="true" T="string">
                                <MudListItem>Load GeoJSON data</MudListItem>
                                <MudListItem>Custom styling per feature</MudListItem>
                                <MudListItem>Feature filtering</MudListItem>
                                <MudListItem>Point to layer callback</MudListItem>
                            </MudList>
                        </MudCardContent>
                    </MudCard>
                </MudItem>

                <MudItem xs="12" sm="4">
                    <MudCard>
                        <MudCardHeader>
                            <MudText Typo="Typo.h6">Interaction Features</MudText>
                        </MudCardHeader>
                        <MudCardContent>
                            <MudList Dense="true" T="string">
                                <MudListItem>Hover effects</MudListItem>
                                <MudListItem>Feature selection</MudListItem>
                                <MudListItem>Multi-select mode</MudListItem>
                                <MudListItem>OnEachFeature callback</MudListItem>
                            </MudList>
                        </MudCardContent>
                    </MudCard>
                </MudItem>

                <MudItem xs="12" sm="4">
                    <MudCard>
                        <MudCardHeader>
                            <MudText Typo="Typo.h6">Callbacks</MudText>
                        </MudCardHeader>
                        <MudCardContent>
                            <MudText Typo="Typo.body2">
                                <strong>Style:</strong> Custom per feature<br/>
                                <strong>Filter:</strong> Include all<br/>
                                <strong>OnEachFeature:</strong> Enabled<br/>
                                <strong>PointToLayer:</strong> Custom markers<br/>
                                <strong>CoordsToLatLng:</strong> Standard
                            </MudText>
                        </MudCardContent>
                    </MudCard>
                </MudItem>
            </MudGrid>
        </MudContainer>
    </div>

    <div style="flex: 1 1 auto; display: flex; flex-direction: row; min-height: 0; overflow: hidden;">
        <div style="flex: 0 0 30%; overflow-y: auto; overflow-x: hidden;">
            <MudContainer MaxWidth="MaxWidth.False" Class="pa-4">
                <MudCard>
                    <MudCardHeader>
                        <MudText Typo="Typo.h6">Controls</MudText>
                    </MudCardHeader>
                    <MudCardContent>
                        <MudButton Variant="Variant.Outlined" Color="Color.Warning" Size="Size.Small" FullWidth="true"
                                   StartIcon="@Icons.Material.Filled.Code"
                                   OnClick="AddGeoJsonLayer"
                                   Disabled="@geoJsonLayerAdded">
                            Load GeoJSON
                        </MudButton>

                        @if (geoJsonLayerAdded)
                        {
                            <MudDivider Class="my-2" />
                            <MudStack Spacing="1">
                                <MudSwitch T="bool" Color="Color.Primary" Label="@($"Selection ({(selectionEnabled ? "On" : "Off")})")"
                                           @bind-Value="@selectionEnabled" Dense="true" />
                                <MudSwitch T="bool" Color="Color.Primary" Label="@($"Multi-Select ({(multiSelectEnabled ? "On" : "Off")})")"
                                           @bind-Value="@multiSelectEnabled" 
                                           Disabled="@(!selectionEnabled)" Dense="true" />
                            </MudStack>

                            <MudButton Variant="Variant.Outlined" Color="Color.Error" Size="Size.Small" FullWidth="true"
                                       StartIcon="@Icons.Material.Filled.Clear"
                                       OnClick="ClearSelection"
                                       Disabled="@(!selectionEnabled)"
                                       Class="mt-2">
                                Clear Selection
                            </MudButton>

                            @if (selectedCount > 0)
                            {
                                <MudAlert Severity="Severity.Success" Dense="true" Class="mt-2">
                                    <strong>Selected:</strong> @selectedCount features
                                </MudAlert>
                            }
                        }
                    </MudCardContent>
                </MudCard>

                <MudButton Variant="Variant.Text" Color="Color.Primary" StartIcon="@Icons.Material.Filled.ArrowBack" Href="/" Class="mt-3">
                    Back to Home
                </MudButton>
            </MudContainer>
        </div>

        <div style="flex: 1 1 70%; min-width: 0; overflow: hidden;">
            <LeafletMap Height="100%" Map="PositionMap" TileLayer="OpenStreetMapsTileLayer" Controls="MapControls" />
        </div>
    </div>
</div>
